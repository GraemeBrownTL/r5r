<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Rafael H. M. Pereira, Marcus Saraiva, Daniel Herszenhut, Carlos Kaue Braga" />

<meta name="date" content="2020-09-18" />

<title>r5r: Rapid Realistic Routing with R5 in R</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>

<style type="text/css">
  p.abstract{
    text-align: center;
    font-weight: bold;
  }
  div.abstract{
    margin: auto;
    width: 90%;
  }
</style>


<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">r5r: Rapid Realistic Routing with R5 in R</h1>
<h4 class="author">Rafael H. M. Pereira, Marcus Saraiva, Daniel Herszenhut, Carlos Kaue Braga</h4>
<h4 class="date">2020-09-18</h4>
<div class="abstract">
<p class="abstract">Abstract</p>
write abstract
</div>



<!-- Examples of similar papers -->
<!--  - https://transportfindings.org/article/8416-accessibility-toolbox-for-r-and-arcgis -->
<!--  - https://transportfindings.org/article/6945-dodgr-an-r-package-for-network-flow-aggregation -->
<!--  - https://joss.theoj.org/papers/10.21105/joss.01926 -->
<p>dasdasdds</p>
<div id="research-questions-and-hypotheses" class="section level1">
<h1>RESEARCH QUESTIONS AND HYPOTHESES</h1>
<p>Transport routing is the process of finding the alternative routes and costs that connect places on a given transport network. Routing often involves complex mathematical algorithms and it is a fundamental step required for transport accessibility analysis, fleet allocation and transport simulation and planning more broadly. Despite the long-standing importance of routing analysis to the field, transport researchers and practitioners still frequently face practical challenges with this task. These challenges involve for example the monetary costs of licensed software, data availability issues for data hungry models, and the long computation times to run multiple routing scenarios, particularly in large and complex multimodal transport networks. While there is a growing number of open source routing models <span class="citation">(OpenTripPlanner n.d.; Lovelace and Ellison 2019; Padgham 2019)</span>, most options available only return the fastest route option between a set of origins and destinations. This simple approach overlooks how often people’s actual route choices deviate from shortest travel time paths due to imperfect information, monetary costs and safety issues among other reasons <span class="citation">(Larsen and El-Geneidy 2011; Zhu and Levinson 2015; Conway and Stewart 2019)</span>.</p>
<p>This paper presents <a href="https://ipeagit.github.io/r5r/">r5r</a>, a new open source R package for rapid realistic routing on multimodal transport networks based on the <a href="https://github.com/conveyal/r5">Rapid Realistic Routing on Real-world and Reimagined networks (R<sup>5</sup>)</a>. R<sup>5</sup> is a powerful next-generation routing engine written in Java and developed at Conveyal <span class="citation">(Conway, Byrd, and van der Linden 2017; Conway, Byrd, and Van Eggermond 2018)</span> to replace its predecessor OpenTripPlanner. The r5r package provides a simple and friendly interface to run R<sup>5</sup> locally from within R, what allows users to efficiently calculate travel time matrices or generate multiple route alternatives between origins and destinations using seamless parallel computing.</p>
</div>
<div id="methods-and-data" class="section level1">
<h1>METHODS AND DATA</h1>
<p>r5r has low data requirements, enabling routing analysis on different contexts wherever there is open data on street networks from OpenStreetMap (OSM). The package is also easily scalable allowing for fast computations at either the city or country level analysis. For multimodal transport routing, r5r will automatically combine OSM data with one or multiple public transport data sets in the standard GTFS format to create a routable transport network.</p>
<p>The r5r package has 3 fundamental functions. The <code>setup_r5()</code> function builds a multimodal transport network used for routing in R<sup>5</sup>. This function (1) downloads/updates a compiled R<sup>5</sup> JAR file, tailored for the purposes of the package, and stores it locally in the r5r package directory for future use; and (2) combines the OSM and GTFS data sets to build a routable network object. For fast routing analysis, r5r currently has two functions:</p>
<ul>
<li><p><code>travel_time_matrix()</code>: used to compute travel time estimates between one or multiple origin/destination pairs. The origin/destination input can be either a spatial <code>sf POINT</code> object, or a <code>data.frame</code> containing the columns <code>id</code>, <code>lon</code>, <code>lat.</code></p></li>
<li><p><code>detailed_itineraries()</code>: used to compute detailed information at the trip segment level on either the shortest or multiple alternative routes between one or multiple origin/destination pairs. Includes information such as the transport mode, waiting time, travel time and distance.</p></li>
</ul>
<p>Both routing functions are versatile so users can easily set customized inputs such as transport mode, departure date and times, walking and cycling speeds, maximum trip duration, walking distances and number of public transport transfers, etc.</p>
</div>
<div id="findings" class="section level1">
<h1>FINDINGS</h1>
<p>The package can be installed with the following commands:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># stable version</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">install.packages</span>(<span class="st">&quot;r5r&quot;</span>)</span>
<span id="cb1-3"><a href="#cb1-3"></a></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co"># development version</span></span>
<span id="cb1-5"><a href="#cb1-5"></a>devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;ipeaGIT/r5r&quot;</span>, <span class="dt">subdir =</span> <span class="st">&quot;r-package&quot;</span>)</span></code></pre></div>
<p>The first step when using r5r is to set the amount of memory available to Java. By default <code>R</code> allocates only 512 MB of memory for Java processes, which is not enough for large queries using r5r. To increase available memory to 2GB, for example, we need to set the <code>java.parameters</code> option at the beginning of the script as follows:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">options</span>(<span class="dt">java.parameters =</span> <span class="st">&quot;-Xmx2G&quot;</span>)</span></code></pre></div>
<p>Please note that <code>R</code> only allocates memory to Java once during a running session. If a Java process has been initiated before, either by r5r or any other Java-dependent package or function, it might be required to restart the current <code>R</code> session in order to effectively change the amount of memory allocated.</p>
<p>The package can be attached (with some other packages used in this article) with the following command:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw">library</span>(r5r)</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="kw">library</span>(sf)</span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="kw">library</span>(data.table)</span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="kw">library</span>(ggplot2)</span></code></pre></div>
<p>To illustrate functionality, the package includes a small sample data set for the city of Porto Alegre (Brazil). It includes three files:</p>
<ul>
<li>An OSM network in <code>.pbf</code> format.</li>
<li>A public transport network in <code>GTFS.zip</code> format.</li>
<li>The spatial coordinates of points covering the area in <code>.csv</code> format.</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>data_path &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;r5r&quot;</span>)</span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="kw">list.files</span>(data_path)</span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="co">#&gt; [1] &quot;network.dat&quot;                &quot;poa.zip&quot;                   </span></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="co">#&gt; [3] &quot;poa_hexgrid.csv&quot;            &quot;poa_osm.pbf&quot;               </span></span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="co">#&gt; [5] &quot;poa_osm.pbf.mapdb&quot;          &quot;poa_osm.pbf.mapdb.p&quot;       </span></span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="co">#&gt; [7] &quot;poa_points_of_interest.csv&quot;</span></span>
<span id="cb4-7"><a href="#cb4-7"></a></span>
<span id="cb4-8"><a href="#cb4-8"></a>points &lt;-<span class="st"> </span><span class="kw">fread</span>(<span class="kw">system.file</span>(<span class="st">&quot;extdata/poa_hexgrid.csv&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;r5r&quot;</span>))</span>
<span id="cb4-9"><a href="#cb4-9"></a>points &lt;-<span class="st"> </span>points[<span class="kw">c</span>(<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(points), <span class="dv">100</span>))]</span>
<span id="cb4-10"><a href="#cb4-10"></a><span class="kw">head</span>(points)</span>
<span id="cb4-11"><a href="#cb4-11"></a><span class="co">#&gt;                 id       lon       lat</span></span>
<span id="cb4-12"><a href="#cb4-12"></a><span class="co">#&gt; 1: 89a90128217ffff -51.17689 -30.06336</span></span>
<span id="cb4-13"><a href="#cb4-13"></a><span class="co">#&gt; 2: 89a90129567ffff -51.15263 -30.06542</span></span>
<span id="cb4-14"><a href="#cb4-14"></a><span class="co">#&gt; 3: 89a9012a3b3ffff -51.22708 -30.10066</span></span>
<span id="cb4-15"><a href="#cb4-15"></a><span class="co">#&gt; 4: 89a9012989bffff -51.17257 -30.03182</span></span>
<span id="cb4-16"><a href="#cb4-16"></a><span class="co">#&gt; 5: 89a901298cbffff -51.16330 -30.02844</span></span>
<span id="cb4-17"><a href="#cb4-17"></a><span class="co">#&gt; 6: 89a9012a317ffff -51.22091 -30.09842</span></span></code></pre></div>
<div id="build-a-routable-transport-network" class="section level3">
<h3>Build a routable transport network</h3>
<p>Building a transport network with r5r is as simple as a one command line:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>r5r_core &lt;-<span class="st"> </span><span class="kw">setup_r5</span>(data_path)</span></code></pre></div>
<p>The function uses the <code>.pbf</code> and the <code>GTFS.zip</code> files in the directory pointed by <code>data_path</code> to create a multimodal transport network used for routing by R<sup>5</sup>. The resulting <code>network.dat</code>, as well as some other files used by R<sup>5</sup>, is saved inside the supplied directory.</p>
<p>While the presence of a <code>.pbf</code> file is mandatory, since it is required to create a street network, the <code>GTFS.zip</code> file is only used to calculate public transport trips, thus may not be necessary if that’s not intended. Multiple GTFS can be used simultaneously, in which case all files are merged into a single one automatically.</p>
</div>
<div id="calculate-a-travel-time-matrix" class="section level3">
<h3>Calculate a travel time matrix</h3>
<p>Calculating a travel time matrix with r5r can be done very efficiently with the <code>travel_time_matrix()</code> function. The function takes travel restrictions and origins/destinations spatial location as inputs and outputs a <code>data.table</code> with the travel time between all combinations of origins and destinations that can be reached with the given restrictions:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># set restrictions</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>mode &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;WALK&quot;</span>, <span class="st">&quot;TRANSIT&quot;</span>)</span>
<span id="cb6-3"><a href="#cb6-3"></a>max_walk_dist &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb6-4"><a href="#cb6-4"></a>max_trip_duration &lt;-<span class="st"> </span><span class="dv">120</span></span>
<span id="cb6-5"><a href="#cb6-5"></a>departure_datetime &lt;-<span class="st"> </span><span class="kw">as.POSIXct</span>(<span class="st">&quot;13-03-2019 14:00:00&quot;</span>,</span>
<span id="cb6-6"><a href="#cb6-6"></a>                                 <span class="dt">format =</span> <span class="st">&quot;%d-%m-%Y %H:%M:%S&quot;</span>)</span>
<span id="cb6-7"><a href="#cb6-7"></a></span>
<span id="cb6-8"><a href="#cb6-8"></a><span class="co"># calculate travel time matrix</span></span>
<span id="cb6-9"><a href="#cb6-9"></a>ttm &lt;-<span class="st"> </span><span class="kw">travel_time_matrix</span>(r5r_core,</span>
<span id="cb6-10"><a href="#cb6-10"></a>                          <span class="dt">origins =</span> points,</span>
<span id="cb6-11"><a href="#cb6-11"></a>                          <span class="dt">destinations =</span> points,</span>
<span id="cb6-12"><a href="#cb6-12"></a>                          mode,</span>
<span id="cb6-13"><a href="#cb6-13"></a>                          departure_datetime,</span>
<span id="cb6-14"><a href="#cb6-14"></a>                          max_walk_dist,</span>
<span id="cb6-15"><a href="#cb6-15"></a>                          max_trip_duration)</span>
<span id="cb6-16"><a href="#cb6-16"></a></span>
<span id="cb6-17"><a href="#cb6-17"></a>ttm</span>
<span id="cb6-18"><a href="#cb6-18"></a><span class="co">#&gt;                fromId            toId travel_time</span></span>
<span id="cb6-19"><a href="#cb6-19"></a><span class="co">#&gt;    1: 89a90128217ffff 89a90128217ffff           1</span></span>
<span id="cb6-20"><a href="#cb6-20"></a><span class="co">#&gt;    2: 89a90128217ffff 89a9012828fffff          12</span></span>
<span id="cb6-21"><a href="#cb6-21"></a><span class="co">#&gt;    3: 89a90128217ffff 89a9012820bffff          12</span></span>
<span id="cb6-22"><a href="#cb6-22"></a><span class="co">#&gt;    4: 89a90128217ffff 89a901282d7ffff          16</span></span>
<span id="cb6-23"><a href="#cb6-23"></a><span class="co">#&gt;    5: 89a90128217ffff 89a901282a3ffff          18</span></span>
<span id="cb6-24"><a href="#cb6-24"></a><span class="co">#&gt;   ---                                            </span></span>
<span id="cb6-25"><a href="#cb6-25"></a><span class="co">#&gt; 1039: 89a90129967ffff 89a90128063ffff          57</span></span>
<span id="cb6-26"><a href="#cb6-26"></a><span class="co">#&gt; 1040: 89a90129967ffff 89a9012aa6fffff          77</span></span>
<span id="cb6-27"><a href="#cb6-27"></a><span class="co">#&gt; 1041: 89a90129967ffff 89a90129897ffff          32</span></span>
<span id="cb6-28"><a href="#cb6-28"></a><span class="co">#&gt; 1042: 89a90129967ffff 89a90128557ffff          82</span></span>
<span id="cb6-29"><a href="#cb6-29"></a><span class="co">#&gt; 1043: 89a90129967ffff 89a90129967ffff           0</span></span></code></pre></div>
<p>Note that the resulting <code>ttm</code> object only holds the travel time of 1043 origin/destination pairs, even though the <code>points</code> data set passed both to <code>origins</code> and <code>destinations</code> argument contains 100 points. This is because out of the total 10000 possible trips between the supplied points, only 1043 could be completed within the specified restrictions. Removing any walking distance limits (by setting it to infinite) and increasing maximum trip duration accordingly results in a “complete” output:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># set softer restrictions</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>max_walk_dist &lt;-<span class="st"> </span><span class="ot">Inf</span></span>
<span id="cb7-3"><a href="#cb7-3"></a>max_trip_duration &lt;-<span class="st"> </span><span class="dv">360</span></span>
<span id="cb7-4"><a href="#cb7-4"></a></span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="co"># calculate travel time matrix</span></span>
<span id="cb7-6"><a href="#cb7-6"></a>ttm &lt;-<span class="st"> </span><span class="kw">travel_time_matrix</span>(r5r_core,</span>
<span id="cb7-7"><a href="#cb7-7"></a>                          <span class="dt">origins =</span> points,</span>
<span id="cb7-8"><a href="#cb7-8"></a>                          <span class="dt">destinations =</span> points,</span>
<span id="cb7-9"><a href="#cb7-9"></a>                          mode,</span>
<span id="cb7-10"><a href="#cb7-10"></a>                          departure_datetime,</span>
<span id="cb7-11"><a href="#cb7-11"></a>                          max_walk_dist,</span>
<span id="cb7-12"><a href="#cb7-12"></a>                          max_trip_duration)</span>
<span id="cb7-13"><a href="#cb7-13"></a></span>
<span id="cb7-14"><a href="#cb7-14"></a>ttm</span>
<span id="cb7-15"><a href="#cb7-15"></a><span class="co">#&gt;                 fromId            toId travel_time</span></span>
<span id="cb7-16"><a href="#cb7-16"></a><span class="co">#&gt;     1: 89a90128217ffff 89a90128217ffff           1</span></span>
<span id="cb7-17"><a href="#cb7-17"></a><span class="co">#&gt;     2: 89a90128217ffff 89a90129567ffff          42</span></span>
<span id="cb7-18"><a href="#cb7-18"></a><span class="co">#&gt;     3: 89a90128217ffff 89a9012a3b3ffff          93</span></span>
<span id="cb7-19"><a href="#cb7-19"></a><span class="co">#&gt;     4: 89a90128217ffff 89a9012989bffff          77</span></span>
<span id="cb7-20"><a href="#cb7-20"></a><span class="co">#&gt;     5: 89a90128217ffff 89a901298cbffff          83</span></span>
<span id="cb7-21"><a href="#cb7-21"></a><span class="co">#&gt;    ---                                            </span></span>
<span id="cb7-22"><a href="#cb7-22"></a><span class="co">#&gt;  9996: 89a90129967ffff 89a90129897ffff          32</span></span>
<span id="cb7-23"><a href="#cb7-23"></a><span class="co">#&gt;  9997: 89a90129967ffff 89a901295afffff         150</span></span>
<span id="cb7-24"><a href="#cb7-24"></a><span class="co">#&gt;  9998: 89a90129967ffff 89a90129143ffff         149</span></span>
<span id="cb7-25"><a href="#cb7-25"></a><span class="co">#&gt;  9999: 89a90129967ffff 89a90128557ffff          71</span></span>
<span id="cb7-26"><a href="#cb7-26"></a><span class="co">#&gt; 10000: 89a90129967ffff 89a90129967ffff           0</span></span></code></pre></div>
</div>
<div id="calculate-detailed-itineraries" class="section level3">
<h3>Calculate detailed itineraries</h3>
<p>Often enough one wants more information on the itineraries between origin/destination pairs than simply the travel time. For such cases, the package includes the <code>detailed_itineraries()</code> function, which also takes travel restrictions as inputs, but outputs a much more detailed data set at the trip segment level. Another key feature of this function is that it (optionally) provides multiple alternative routes between origin/destination pairs:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># load points of interests and set origin and destination</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>points &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="kw">file.path</span>(data_path, <span class="st">&quot;poa_points_of_interest.csv&quot;</span>))</span>
<span id="cb8-3"><a href="#cb8-3"></a>origins &lt;-<span class="st"> </span>points[<span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">14</span>),]</span>
<span id="cb8-4"><a href="#cb8-4"></a>destinations &lt;-<span class="st"> </span>points[<span class="kw">c</span>(<span class="dv">12</span>, <span class="dv">15</span>),]</span>
<span id="cb8-5"><a href="#cb8-5"></a></span>
<span id="cb8-6"><a href="#cb8-6"></a><span class="co"># set restrictions</span></span>
<span id="cb8-7"><a href="#cb8-7"></a>mode &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;WALK&quot;</span>, <span class="st">&quot;TRANSIT&quot;</span>)</span>
<span id="cb8-8"><a href="#cb8-8"></a>max_walk_dist &lt;-<span class="st"> </span><span class="ot">Inf</span></span>
<span id="cb8-9"><a href="#cb8-9"></a>max_trip_duration &lt;-<span class="st"> </span><span class="dv">120</span></span>
<span id="cb8-10"><a href="#cb8-10"></a>departure_datetime &lt;-<span class="st"> </span><span class="kw">as.POSIXct</span>(<span class="st">&quot;13-03-2019 14:00:00&quot;</span>,</span>
<span id="cb8-11"><a href="#cb8-11"></a>                                 <span class="dt">format =</span> <span class="st">&quot;%d-%m-%Y %H:%M:%S&quot;</span>)</span>
<span id="cb8-12"><a href="#cb8-12"></a></span>
<span id="cb8-13"><a href="#cb8-13"></a>dit &lt;-<span class="st"> </span><span class="kw">detailed_itineraries</span>(r5r_core,</span>
<span id="cb8-14"><a href="#cb8-14"></a>                            origins,</span>
<span id="cb8-15"><a href="#cb8-15"></a>                            destinations,</span>
<span id="cb8-16"><a href="#cb8-16"></a>                            mode,</span>
<span id="cb8-17"><a href="#cb8-17"></a>                            departure_datetime,</span>
<span id="cb8-18"><a href="#cb8-18"></a>                            max_walk_dist,</span>
<span id="cb8-19"><a href="#cb8-19"></a>                            <span class="dt">shortest_path =</span> <span class="ot">FALSE</span>)</span>
<span id="cb8-20"><a href="#cb8-20"></a></span>
<span id="cb8-21"><a href="#cb8-21"></a>dit</span>
<span id="cb8-22"><a href="#cb8-22"></a><span class="co">#&gt; Simple feature collection with 11 features and 14 fields</span></span>
<span id="cb8-23"><a href="#cb8-23"></a><span class="co">#&gt; geometry type:  LINESTRING</span></span>
<span id="cb8-24"><a href="#cb8-24"></a><span class="co">#&gt; dimension:      XY</span></span>
<span id="cb8-25"><a href="#cb8-25"></a><span class="co">#&gt; bbox:           xmin: -51.22972 ymin: -30.07325 xmax: -51.17479 ymax: -29.99884</span></span>
<span id="cb8-26"><a href="#cb8-26"></a><span class="co">#&gt; geographic CRS: WGS 84</span></span>
<span id="cb8-27"><a href="#cb8-27"></a><span class="co">#&gt; First 10 features:</span></span>
<span id="cb8-28"><a href="#cb8-28"></a><span class="co">#&gt;              fromId   fromLat   fromLon                           toId</span></span>
<span id="cb8-29"><a href="#cb8-29"></a><span class="co">#&gt; 1  farrapos_station -29.99772 -51.19762 praia_de_belas_shopping_center</span></span>
<span id="cb8-30"><a href="#cb8-30"></a><span class="co">#&gt; 2  farrapos_station -29.99772 -51.19762 praia_de_belas_shopping_center</span></span>
<span id="cb8-31"><a href="#cb8-31"></a><span class="co">#&gt; 3  farrapos_station -29.99772 -51.19762 praia_de_belas_shopping_center</span></span>
<span id="cb8-32"><a href="#cb8-32"></a><span class="co">#&gt; 4  farrapos_station -29.99772 -51.19762 praia_de_belas_shopping_center</span></span>
<span id="cb8-33"><a href="#cb8-33"></a><span class="co">#&gt; 5  farrapos_station -29.99772 -51.19762 praia_de_belas_shopping_center</span></span>
<span id="cb8-34"><a href="#cb8-34"></a><span class="co">#&gt; 6  farrapos_station -29.99772 -51.19762 praia_de_belas_shopping_center</span></span>
<span id="cb8-35"><a href="#cb8-35"></a><span class="co">#&gt; 7  farrapos_station -29.99772 -51.19762 praia_de_belas_shopping_center</span></span>
<span id="cb8-36"><a href="#cb8-36"></a><span class="co">#&gt; 8             ufrgs -30.03340 -51.22028                          pucrs</span></span>
<span id="cb8-37"><a href="#cb8-37"></a><span class="co">#&gt; 9             ufrgs -30.03340 -51.22028                          pucrs</span></span>
<span id="cb8-38"><a href="#cb8-38"></a><span class="co">#&gt; 10            ufrgs -30.03340 -51.22028                          pucrs</span></span>
<span id="cb8-39"><a href="#cb8-39"></a><span class="co">#&gt;        toLat     toLon option segment mode total_duration segment_duration</span></span>
<span id="cb8-40"><a href="#cb8-40"></a><span class="co">#&gt; 1  -30.04995 -51.22875      1       1 WALK      119.40000       119.400000</span></span>
<span id="cb8-41"><a href="#cb8-41"></a><span class="co">#&gt; 2  -30.04995 -51.22875      2       1 WALK       69.21667        11.116667</span></span>
<span id="cb8-42"><a href="#cb8-42"></a><span class="co">#&gt; 3  -30.04995 -51.22875      2       2  BUS       69.21667        45.583333</span></span>
<span id="cb8-43"><a href="#cb8-43"></a><span class="co">#&gt; 4  -30.04995 -51.22875      2       3 WALK       69.21667         8.216667</span></span>
<span id="cb8-44"><a href="#cb8-44"></a><span class="co">#&gt; 5  -30.04995 -51.22875      3       1 WALK       69.21667         8.716667</span></span>
<span id="cb8-45"><a href="#cb8-45"></a><span class="co">#&gt; 6  -30.04995 -51.22875      3       2  BUS       69.21667        46.000000</span></span>
<span id="cb8-46"><a href="#cb8-46"></a><span class="co">#&gt; 7  -30.04995 -51.22875      3       3 WALK       69.21667         8.216667</span></span>
<span id="cb8-47"><a href="#cb8-47"></a><span class="co">#&gt; 8  -30.05797 -51.17607      1       1 WALK       95.16667        95.166667</span></span>
<span id="cb8-48"><a href="#cb8-48"></a><span class="co">#&gt; 9  -30.05797 -51.17607      2       1 WALK       93.10000         6.066667</span></span>
<span id="cb8-49"><a href="#cb8-49"></a><span class="co">#&gt; 10 -30.05797 -51.17607      2       2  BUS       93.10000         4.550000</span></span>
<span id="cb8-50"><a href="#cb8-50"></a><span class="co">#&gt;         wait distance   route                       geometry</span></span>
<span id="cb8-51"><a href="#cb8-51"></a><span class="co">#&gt; 1   0.000000     7002         LINESTRING (-51.19807 -29.9...</span></span>
<span id="cb8-52"><a href="#cb8-52"></a><span class="co">#&gt; 2   0.000000      562         LINESTRING (-51.19807 -29.9...</span></span>
<span id="cb8-53"><a href="#cb8-53"></a><span class="co">#&gt; 3   4.300000    15131  poa:T2 LINESTRING (-51.19997 -30.0...</span></span>
<span id="cb8-54"><a href="#cb8-54"></a><span class="co">#&gt; 4   0.000000      483         LINESTRING (-51.22846 -30.0...</span></span>
<span id="cb8-55"><a href="#cb8-55"></a><span class="co">#&gt; 5   0.000000      420         LINESTRING (-51.19807 -29.9...</span></span>
<span id="cb8-56"><a href="#cb8-56"></a><span class="co">#&gt; 6   6.283333    15274  poa:T2 LINESTRING (-51.1995 -30.00...</span></span>
<span id="cb8-57"><a href="#cb8-57"></a><span class="co">#&gt; 7   0.000000      483         LINESTRING (-51.22846 -30.0...</span></span>
<span id="cb8-58"><a href="#cb8-58"></a><span class="co">#&gt; 8   0.000000     5756         LINESTRING (-51.22032 -30.0...</span></span>
<span id="cb8-59"><a href="#cb8-59"></a><span class="co">#&gt; 9   0.000000      381         LINESTRING (-51.22022 -30.0...</span></span>
<span id="cb8-60"><a href="#cb8-60"></a><span class="co">#&gt; 10 12.033333     1884 poa:R10 LINESTRING (-51.22202 -30.0...</span></span></code></pre></div>
<p>Since the <code>shortest_path</code> argument has been set to <code>FALSE</code>, <code>dit</code> holds information for multiple itineraries between the same origin/destination pairs:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw">setDT</span>(<span class="kw">copy</span>(dit))[, .(<span class="dt">n_itineraries =</span> <span class="kw">uniqueN</span>(option)), by =<span class="st"> </span>.(fromId, toId)]</span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="co">#&gt;              fromId                           toId n_itineraries</span></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="co">#&gt; 1: farrapos_station praia_de_belas_shopping_center             3</span></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="co">#&gt; 2:            ufrgs                          pucrs             2</span></span></code></pre></div>
<p>Had <code>shortest_path</code> been set to <code>TRUE</code>, only the shortest path would have been returned:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>dit_short &lt;-<span class="st"> </span><span class="kw">detailed_itineraries</span>(r5r_core,</span>
<span id="cb10-2"><a href="#cb10-2"></a>                                  origins,</span>
<span id="cb10-3"><a href="#cb10-3"></a>                                  destinations,</span>
<span id="cb10-4"><a href="#cb10-4"></a>                                  mode,</span>
<span id="cb10-5"><a href="#cb10-5"></a>                                  departure_datetime,</span>
<span id="cb10-6"><a href="#cb10-6"></a>                                  max_walk_dist,</span>
<span id="cb10-7"><a href="#cb10-7"></a>                                  <span class="dt">shortest_path =</span> <span class="ot">TRUE</span>)</span>
<span id="cb10-8"><a href="#cb10-8"></a></span>
<span id="cb10-9"><a href="#cb10-9"></a><span class="kw">setDT</span>(<span class="kw">copy</span>(dit_short))[, .(<span class="dt">n_itineraries =</span> <span class="kw">uniqueN</span>(option)), by =<span class="st"> </span>.(fromId, toId)]</span>
<span id="cb10-10"><a href="#cb10-10"></a><span class="co">#&gt;              fromId                           toId n_itineraries</span></span>
<span id="cb10-11"><a href="#cb10-11"></a><span class="co">#&gt; 1: farrapos_station praia_de_belas_shopping_center             1</span></span>
<span id="cb10-12"><a href="#cb10-12"></a><span class="co">#&gt; 2:            ufrgs                          pucrs             1</span></span></code></pre></div>
</div>
<div id="visualize-results" class="section level3">
<h3>visualize results</h3>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="co"># extract OSM network</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>street_net &lt;-<span class="st"> </span><span class="kw">street_network_to_sf</span>(r5r_core)</span>
<span id="cb11-3"><a href="#cb11-3"></a></span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="co"># plot</span></span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="st">   </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> street_net<span class="op">$</span>edges, <span class="dt">color=</span><span class="st">&#39;gray85&#39;</span>) <span class="op">+</span></span>
<span id="cb11-7"><a href="#cb11-7"></a><span class="st">   </span><span class="kw">theme_minimal</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="acknowledgments" class="section level1">
<h1>Acknowledgments</h1>
<p>Conveyal for R5</p>
</div>
<div id="references" class="section level1">
<h1>References</h1>
<!-- Rafa's notes -->
<!-- jean: #>-  mass of assumptions regarding decision-making and routing (Miller, 2018).  -->
<!-- Haugen, 2011; Schwanen, 2008 -->
<!-- Miller, E.J., 2018. Accessibility: measurement and application in transportation planning. Transp. Rev. 38, #>551–555. https://doi.org/10.1080/01441647.2018.1492778 -->
<!-- This article presents **r5r**, a new open-source `R` package for rapid  -->
<!-- realistic routing on multimodal transport networks. -->
<div id="refs" class="references">
<div id="ref-conway2017evidencebased">
<p>Conway, Matthew Wigginton, Andrew Byrd, and Marco van der Linden. 2017. “Evidence-Based Transit and Land Use Sketch Planning Using Interactive Accessibility Methods on Combined Schedule and Headway-Based Networks.” <em>Transportation Research Record: Journal of the Transportation Research Board</em> 2653 (1): 45–53. <a href="https://doi.org/10.3141/2653-06">https://doi.org/10.3141/2653-06</a>.</p>
</div>
<div id="ref-conway2018accounting">
<p>Conway, Matthew Wigginton, Andrew Byrd, and Michael Van Eggermond. 2018. “Accounting for Uncertainty and Variation in Accessibility Metrics for Public Transport Sketch Planning.” <em>Journal of Transport and Land Use</em> 11 (1). <a href="https://doi.org/10.5198/jtlu.2018.1074">https://doi.org/10.5198/jtlu.2018.1074</a>.</p>
</div>
<div id="ref-conway2019getting">
<p>Conway, Matthew Wigginton, and Anson F. Stewart. 2019. “Getting Charlie Off the MTA: A Multiobjective Optimization Method to Account for Cost Constraints in Public Transit Accessibility Metrics.” <em>International Journal of Geographical Information Science</em> 33 (9): 1759–87. <a href="https://doi.org/10.1080/13658816.2019.1605075">https://doi.org/10.1080/13658816.2019.1605075</a>.</p>
</div>
<div id="ref-larsen2011travel">
<p>Larsen, Jacob, and Ahmed El-Geneidy. 2011. “A Travel Behavior Analysis of Urban Cycling Facilities in Montréal, Canada.” <em>Transportation Research Part D: Transport and Environment</em> 16 (2): 172–77. <a href="https://doi.org/10.1016/j.trd.2010.07.011">https://doi.org/10.1016/j.trd.2010.07.011</a>.</p>
</div>
<div id="ref-lovelace2019stplanr">
<p>Lovelace, Robin, and Richard Ellison. 2019. “Stplanr: A Package for Transport Planning.” <em>The R Journal</em> 10 (2): 7. <a href="https://doi.org/10.32614/RJ-2018-053">https://doi.org/10.32614/RJ-2018-053</a>.</p>
</div>
<div id="ref-opentripplanneropentripplanner">
<p>OpenTripPlanner. n.d. “OpenTripPlanner.” Accessed September 17, 2020. <a href="http://www.opentripplanner.org/">http://www.opentripplanner.org/</a>.</p>
</div>
<div id="ref-padgham2019dodgr">
<p>Padgham, Mark. 2019. “Dodgr: An R Package for Network Flow Aggregation.” <em>Transport Findings</em>, 02-14. <a href="https://doi.org/10.32866/6945">https://doi.org/10.32866/6945</a>.</p>
</div>
<div id="ref-zhu2015people">
<p>Zhu, Shanjiang, and David Levinson. 2015. “Do People Use the Shortest Path? An Empirical Test of Wardrop’s First Principle.” Edited by Yan Ropert-Coudert. <em>PLOS ONE</em> 10 (8): e0134322. <a href="https://doi.org/10.1371/journal.pone.0134322">https://doi.org/10.1371/journal.pone.0134322</a>.</p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
